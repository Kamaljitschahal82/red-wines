# Chunk 1: global_options
knitr::opts_chunk$set(fig.width=12, fig.height=8, width = 200,
echo=FALSE, warning=FALSE, message=FALSE)
# Chunk 2
# Load all of the packages that you end up using
# in your analysis in this code chunk.
# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.
library(plyr)
library(gridExtra)
library(ggplot2)
library(GGally)
library(scales)
library(memisc)
# Chunk 3
# Load the Data
#setwd("E:/Dropbox/estudios/dataAnalyst/p4/p4_explore")
setwd("C:/Users/Administrador/Dropbox/estudios/dataAnalyst/p4/p4_explore")
reds <- read.csv('wineQualityReds.csv')
# Chunk 4
names(reds)
# Chunk 5
reds <- plyr::rename(reds, c("X"="id"))
str(reds)
# Chunk 6
reds$quality <- factor(reds$quality)
# Chunk 7
with(reds, subset(free.sulfur.dioxide, free.sulfur.dioxide %% 1 != 0))
with(reds, subset(total.sulfur.dioxide, total.sulfur.dioxide %% 1 != 0))
# Chunk 8
summary(reds)
# Chunk 9
ggplot(data = reds, aes(x = fixed.acidity)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(breaks = seq(4, 16, 1), limits = c(4, 16))
# Chunk 10
ggplot(data = reds, aes(x = volatile.acidity)) +
geom_histogram(binwidth = 0.05) +
scale_x_continuous(breaks = seq(0, 2, 0.1), limits = c(0, 2))
# Chunk 11
c1 <- ggplot(data = reds, aes(x = citric.acid)) +
geom_histogram(binwidth = 0.05) +
scale_x_continuous(breaks = seq(0, 1.2, 0.1), limits = c(0, 1.2))
c2 <- ggplot(data = reds, aes(x = citric.acid)) +
geom_histogram(binwidth = 0.05) +
scale_x_log10(breaks = seq(0, 1.2, 0.1))
grid.arrange(c1, c2, ncol=1)
# Chunk 12
r1 <- ggplot(data = reds, aes(x = residual.sugar)) +
geom_histogram(binwidth = 0.1)
r2 <- ggplot(data = reds, aes(x = residual.sugar)) +
geom_histogram(binwidth = 0.1) +
scale_x_continuous(breaks = seq(0, 3.5, 0.5), limits = c(0, 3.5))
grid.arrange(r1, r2, ncol=1)
# Chunk 13
ch1 <- ggplot(data = reds, aes(x = chlorides)) +
geom_histogram(binwidth = 0.005)
ch2 <- ggplot(data = reds, aes(x = chlorides)) +
geom_histogram(binwidth = 0.005) +
scale_x_continuous(breaks = seq(0, 0.15, 0.05), limits = c(0, 0.15))
grid.arrange(ch1, ch2, ncol=1)
# Chunk 14
fsd1 <- ggplot(data = reds, aes(x = free.sulfur.dioxide)) +
geom_histogram(binwidth = 1) +
scale_x_continuous(breaks = seq(0, 80, 5))
fsd2 <- ggplot(data = reds, aes(x = free.sulfur.dioxide)) +
geom_histogram(binwidth = 0.1) +
scale_x_log10(breaks = seq(0, 80, 10))
grid.arrange(fsd1, fsd2, ncol=1)
# Chunk 15
tsd1 <- ggplot(data = reds, aes(x = total.sulfur.dioxide)) +
geom_histogram(binwidth = 5) +
scale_x_continuous(breaks = seq(0, 290, 10))
tsd2 <- ggplot(data = reds, aes(x = total.sulfur.dioxide)) +
geom_histogram(binwidth = 0.1) +
scale_x_log10(breaks = seq(0, 290, 25))
grid.arrange(tsd1, tsd2, ncol=1)
# Chunk 16
ggplot(data = reds, aes(x = density)) +
geom_histogram(binwidth = 0.0005)
# Chunk 17
ggplot(data = reds, aes(x = pH)) +
geom_histogram(binwidth = 0.05)
# Chunk 18
ggplot(data = reds, aes(x = sulphates)) +
geom_histogram(binwidth = 0.05)
# Chunk 19
a1 <- ggplot(data = reds, aes(x = alcohol)) +
geom_histogram(binwidth = 0.1)
a2 <- ggplot(data = reds, aes(x = alcohol)) +
geom_histogram(binwidth = 0.01) +
scale_x_log10()
grid.arrange(a1, a2, ncol=1)
df.extreme.quality <- subset(reds, quality != 6 & quality != 5)
ggplot(data = reds, aes(x = quality, fill = quality)) +
geom_bar() +
scale_y_continuous(breaks = seq(0, 700, 100)) +
scale_x_discrete(breaks = seq(0, 10, 1)) +
guides(fill = FALSE) +
ggtitle('Quality histogram') +
xlab('Quality') +
ylab('Number of wines')
v1 <- ggplot(data = reds, aes(y = volatile.acidity, x = quality, fill = quality)) +
geom_boxplot() +
guides(fill = FALSE) +
ggtitle('Volatile acidity by quality') +
xlab('Quality') +
ylab('Acetic acid content (g/dm^3)')
v2 <- ggplot(data = reds, aes(volatile.acidity, colour = quality)) +
geom_freqpoly(binwidth = 0.05, size = 1) +
guides(colour = FALSE) +
xlab('Acetic acid content (g/dm^3)') +
ylab('Number of wines')
v3 <- ggplot(data = reds, aes(volatile.acidity, fill = quality)) +
geom_histogram(binwidth = 0.05) +
guides(fill = FALSE) +
xlab('Acetic acid content (g/dm^3)') +
ylab('Number of wines')
c1 <- ggplot(data = reds, aes(y = citric.acid, x = quality, fill = quality)) +
geom_boxplot() +
guides(fill = FALSE) +
ggtitle('Citric acid by quality') +
xlab('Quality') +
ylab('Citric acid content (g/dm^3)')
c2 <- ggplot(data = reds, aes(citric.acid, colour = quality)) +
geom_freqpoly(binwidth = 0.05, size = 1) +
guides(colour = FALSE) +
xlab('Citric acid content (g/dm^3)') +
ylab('')
c3 <- ggplot(data = reds, aes(citric.acid, fill = quality)) +
geom_histogram(binwidth = 0.05) +
guides(fill = FALSE) +
xlab('Citric acid content (g/dm^3)') +
ylab('')
a1 <- ggplot(data = reds, aes(y = alcohol, x = quality, fill = quality)) +
geom_boxplot() +
guides(fill = FALSE) +
ggtitle('Alcohol by quality') +
xlab('Quality') +
ylab('Alcohol content (% by volume)')
a2 <- ggplot(data = reds, aes(alcohol, colour = quality)) +
geom_freqpoly(binwidth = 0.1, size = 1) +
xlab('Alcohol content (% by volume)') +
ylab('')
a3 <- ggplot(data = reds, aes(alcohol, fill = quality)) +
geom_histogram(binwidth = 0.1) +
xlab('Alcohol content (% by volume)') +
ylab('')
grid.arrange(v1, c1, a1, v2, c2, a2, v3, c3, a3, ncol=3)
ggplot(data = df.extreme.quality, aes(y = citric.acid, x = alcohol, colour=quality, size=volatile.acidity)) +
geom_point() +
ggtitle('The three most influential features versus quality in extreme quality wines') +
xlab('Alcohol content (% by volume)') +
ylab('Citric acid content (g/dm^3)') +
scale_size_continuous(name='acetic acid (g/dm^3)')
